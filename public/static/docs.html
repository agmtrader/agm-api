<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGM API Documentation</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
            color: #062D47;
        }
        .endpoint {
            margin-bottom: 30px;
            padding: 25px;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .endpoint:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .method {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 4px;
            font-weight: bold;
            margin-right: 10px;
            font-size: 0.9em;
            text-transform: uppercase;
        }
        .post { background-color: #f26c0d; color: white; }
        .get { background-color: #2571A5; color: white; }
        h1 { 
            color: #062D47;
            font-size: 2.5em;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #f26c0d;
            padding-bottom: 0.5rem;
        }
        h2 { 
            color: #2571A5;
            margin-top: 2rem;
        }
        code {
            background-color: #f1f3f5;
            padding: 3px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Consolas', monospace;
        }
        .route {
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 1.1em;
            color: #f26c0d;
        }
        pre {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #e9ecef;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>AGM API Documentation</h1>

    <div>
        <h2>API Overview</h2>
        <p>All endpoints except the following public routes require JWT authentication:</p>
        <ul>
            <li><code>/docs</code> - API documentation</li>
            <li><code>/</code> - Index page</li>
            <li><code>/token</code> - Token generation</li>
        </ul>

        <p>Include the JWT token in the Authorization header for authenticated requests:</p>
        <code>Authorization: Bearer your_jwt_token</code>
    </div>

    <h2>API Endpoints</h2>
    <div id="routes"></div>

    <script>
        /*
         * List of current AGM-API routes.
         * KEEP THIS LIST UP-TO-DATE WITH src/app/* blueprints.
         */
        const routes = [
            { path: '/', method: 'GET', group: 'Public', description: 'Index page' },
            { path: '/docs', method: 'GET', group: 'Public', description: 'API documentation' },
            { path: '/token', method: 'POST', group: 'Public', description: 'Generate JWT token' },

            // Ada
            { path: '/ada/chat', method: 'POST', group: 'Ada', description: 'Chat with Ada AI assistant' },

            // Applications
            { path: '/applications/create', method: 'POST', group: 'Applications', description: 'Create application' },
            { path: '/applications/read', method: 'GET', group: 'Applications', description: 'Read applications' },
            { path: '/applications/update', method: 'POST', group: 'Applications', description: 'Update application' },
            { path: '/applications/send_to_ibkr', method: 'POST', group: 'Applications', description: 'Send application to IBKR' },

            // Users
            { path: '/users/create', method: 'POST', group: 'Users', description: 'Create user' },
            { path: '/users/login', method: 'POST', group: 'Users', description: 'User login' },
            { path: '/users/read', method: 'GET', group: 'Users', description: 'Read users' },
            { path: '/users/update', method: 'POST', group: 'Users', description: 'Update user' },

            // Accounts
            { path: '/accounts/create', method: 'POST', group: 'Accounts', description: 'Create account' },
            { path: '/accounts/read', method: 'GET', group: 'Accounts', description: 'Read accounts' },
            { path: '/accounts/update', method: 'POST', group: 'Accounts', description: 'Update account' },
            { path: '/accounts/instructions', method: 'POST', group: 'Accounts', description: 'Create instruction' },
            { path: '/accounts/instructions', method: 'GET', group: 'Accounts', description: 'Read instructions' },
            { path: '/accounts/documents', method: 'GET', group: 'Accounts', description: 'Read documents' },
            { path: '/accounts/documents', method: 'POST', group: 'Accounts', description: 'Upload document' },
            { path: '/accounts/ibkr/details', method: 'GET', group: 'Accounts', description: 'Account details' },
            { path: '/accounts/ibkr/documents', method: 'POST', group: 'Accounts', description: 'Submit documents' },
            { path: '/accounts/ibkr/registration_tasks', method: 'GET', group: 'Accounts', description: 'Registration tasks' },
            { path: '/accounts/ibkr/pending_tasks', method: 'GET', group: 'Accounts', description: 'Pending tasks' },
            { path: '/accounts/ibkr/fee_template', method: 'POST', group: 'Accounts', description: 'Apply fee template' },
            { path: '/accounts/ibkr/account_email', method: 'POST', group: 'Accounts', description: 'Update account email' },
            { path: '/accounts/ibkr/pending_alias', method: 'PATCH', group: 'Accounts', description: 'Update pending aliases' },
            { path: '/accounts/ibkr/trading_permissions', method: 'POST', group: 'Accounts', description: 'Add trading permissions' },
            { path: '/accounts/ibkr/clp_capability', method: 'POST', group: 'Accounts', description: 'Add CLP capability' },
            { path: '/accounts/ibkr/bank_instructions', method: 'GET', group: 'Accounts', description: 'View bank instructions' },
            { path: '/accounts/ibkr/withdrawable_cash', method: 'GET', group: 'Accounts', description: 'View withdrawable cash' },
            { path: '/accounts/ibkr/instructions', method: 'GET', group: 'Accounts', description: 'Instruction status' },
            { path: '/accounts/ibkr/sso/create', method: 'POST', group: 'Accounts', description: 'Create SSO session' },
            { path: '/accounts/ibkr/sso/initialize', method: 'POST', group: 'Accounts', description: 'Initialize brokerage session' },
            { path: '/accounts/ibkr/sso/logout', method: 'POST', group: 'Accounts', description: 'Logout brokerage session' },
            { path: '/accounts/ibkr/sso/accounts', method: 'GET', group: 'Accounts', description: 'Get brokerage accounts' },
            { path: '/accounts/ibkr/security_questions', method: 'GET', group: 'Accounts', description: 'Security questions' },
            { path: '/accounts/ibkr/forms', method: 'POST', group: 'Accounts', description: 'Get forms' },
            { path: '/accounts/ibkr/product_country_bundles', method: 'GET', group: 'Accounts', description: 'Product country bundles' },

            // Advisors
            { path: '/advisors/create', method: 'POST', group: 'Advisors', description: 'Create advisor' },
            { path: '/advisors/read', method: 'GET', group: 'Advisors', description: 'Read advisors' },

            // Advisor Changes
            { path: '/advisor_changes/create', method: 'POST', group: 'Advisor Changes', description: 'Create advisor change' },
            { path: '/advisor_changes/read', method: 'GET', group: 'Advisor Changes', description: 'Read advisor changes' },

            // Contacts
            { path: '/contacts/create', method: 'POST', group: 'Contacts', description: 'Create contact' },
            { path: '/contacts/read', method: 'GET', group: 'Contacts', description: 'Read contacts' },
            { path: '/contacts/update', method: 'POST', group: 'Contacts', description: 'Update contact' },

            // Leads
            { path: '/leads/create', method: 'POST', group: 'Leads', description: 'Create lead' },
            { path: '/leads/read', method: 'GET', group: 'Leads', description: 'Read leads' },
            { path: '/leads/update', method: 'POST', group: 'Leads', description: 'Update lead' },
            { path: '/leads/follow_up/create', method: 'POST', group: 'Leads', description: 'Create lead follow-up' },
            { path: '/leads/follow_up/read', method: 'GET', group: 'Leads', description: 'Read lead follow-ups' },
            { path: '/leads/follow_up/update', method: 'POST', group: 'Leads', description: 'Update lead follow-up' },
            { path: '/leads/follow_up/delete', method: 'POST', group: 'Leads', description: 'Delete lead follow-up' },

            // Pending Tasks
            { path: '/pending_tasks/create', method: 'POST', group: 'Pending Tasks', description: 'Create pending task' },
            { path: '/pending_tasks/read', method: 'GET', group: 'Pending Tasks', description: 'Read pending tasks' },
            { path: '/pending_tasks/update', method: 'POST', group: 'Pending Tasks', description: 'Update pending task' },
            { path: '/pending_tasks/follow_up/create', method: 'POST', group: 'Pending Tasks', description: 'Create pending task follow-up' },
            { path: '/pending_tasks/follow_up/update', method: 'POST', group: 'Pending Tasks', description: 'Update pending task follow-up' },
            { path: '/pending_tasks/follow_up/delete', method: 'POST', group: 'Pending Tasks', description: 'Delete pending task follow-up' },

            // Fee Template Requests
            { path: '/fee_template_requests/create', method: 'POST', group: 'Fee Template Requests', description: 'Create fee template request' },
            { path: '/fee_template_requests/read', method: 'GET', group: 'Fee Template Requests', description: 'Read fee template requests' },
            { path: '/fee_template_requests/update', method: 'POST', group: 'Fee Template Requests', description: 'Update fee template request' },

            // Management Type Requests
            { path: '/management_type_requests/create', method: 'POST', group: 'Management Type Requests', description: 'Create management type request' },
            { path: '/management_type_requests/read', method: 'GET', group: 'Management Type Requests', description: 'Read management type requests' },

            // Risk Profiles
            { path: '/risk_profiles/create', method: 'POST', group: 'Risk Profiles', description: 'Create risk profile' },
            { path: '/risk_profiles/read', method: 'GET', group: 'Risk Profiles', description: 'Read risk profiles' },
            { path: '/risk_profiles/list', method: 'GET', group: 'Risk Profiles', description: 'List risk profiles' },

            // Reporting
            { path: '/reporting/run', method: 'GET', group: 'Reporting', description: 'Run reporting pipeline' },
            { path: '/reporting/clients', method: 'GET', group: 'Reporting', description: 'Clients report' },
            { path: '/reporting/nav', method: 'GET', group: 'Reporting', description: 'NAV report' },
            { path: '/reporting/market_data_snapshot', method: 'GET', group: 'Reporting', description: 'Market data snapshot' },

            // Trade Tickets
            { path: '/trade_tickets/list', method: 'GET', group: 'Trade Tickets', description: 'List trade tickets' },
            { path: '/trade_tickets/read', method: 'GET', group: 'Trade Tickets', description: 'Read trade ticket' },
            { path: '/trade_tickets/generate', method: 'POST', group: 'Trade Tickets', description: 'Generate trade ticket' },

            // Emails
            { path: '/email/send_email/trade_ticket', method: 'POST', group: 'Email', description: 'Send trade ticket email' },
            { path: '/email/send_email/email_confirmation', method: 'POST', group: 'Email', description: 'Send email confirmation' },
            { path: '/email/send_email/application_link', method: 'POST', group: 'Email', description: 'Send application link email' },
            { path: '/email/send_email/task_reminder', method: 'POST', group: 'Email', description: 'Send task reminder email' },
            { path: '/email/send_email/lead_reminder', method: 'POST', group: 'Email', description: 'Send lead reminder email' },
            { path: '/email/send_email/credentials', method: 'POST', group: 'Email', description: 'Send credentials email' },
            { path: '/email/send_email/transfer_instructions', method: 'POST', group: 'Email', description: 'Send transfer instructions email' },
        ];

        // Group by API section
        const container = document.getElementById('routes');
        const groups = [...new Set(routes.map(r => r.group))].sort();

        groups.forEach(group => {
            const h2 = document.createElement('h2');
            h2.textContent = group + (group === 'Public' ? '' : ' API');
            container.appendChild(h2);

            routes.filter(r => r.group === group).forEach(route => {
                const div = document.createElement('div');
                div.className = 'endpoint';

                const methodSpan = document.createElement('span');
                methodSpan.className = 'method ' + route.method.toLowerCase();
                methodSpan.textContent = route.method;
                div.appendChild(methodSpan);

                const routeSpan = document.createElement('span');
                routeSpan.className = 'route';
                routeSpan.textContent = route.path;
                div.appendChild(routeSpan);

                if (route.description) {
                    const p = document.createElement('p');
                    p.textContent = route.description;
                    div.appendChild(p);
                }

                container.appendChild(div);
            });
        });
    </script>

</body>
</html> 
